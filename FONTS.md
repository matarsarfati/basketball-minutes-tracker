# Font Setup for PDF Generation

## Heebo Font for Hebrew Support

This project uses the Heebo font for proper Hebrew text rendering in PDF exports generated by pdfmake.

## Font Files

- **Location**: `public/fonts/`
- **Files**:
  - `Heebo-Regular.ttf` (55KB)
  - `Heebo-Bold.ttf` (55KB)
- **Source**: [Google Fonts - Heebo](https://fonts.google.com/specimen/Heebo)

## Generated Font Module

The fonts are pre-converted to base64 format for pdfmake:
- **File**: `src/heeboFonts.js` (150KB, auto-generated)
- **Status**: Ignored by git (regenerate as needed)

## Regenerating Fonts

If you need to update or regenerate the font files:

### 1. Download New Fonts

```bash
curl -L "https://fonts.gstatic.com/s/heebo/v28/NGSpv5_NC0k9P_v6ZUCbLRAHxK1EiSycckOnz02SXQ.ttf" -o public/fonts/Heebo-Regular.ttf
curl -L "https://fonts.gstatic.com/s/heebo/v28/NGSpv5_NC0k9P_v6ZUCbLRAHxK1EbiucckOnz02SXQ.ttf" -o public/fonts/Heebo-Bold.ttf
```

### 2. Convert to Base64 Module

Create a file `convert-fonts.js` in the project root:

```javascript
const fs = require('fs');
const path = require('path');

const fonts = {
  'Heebo-Regular.ttf': path.join(__dirname, 'public/fonts/Heebo-Regular.ttf'),
  'Heebo-Bold.ttf': path.join(__dirname, 'public/fonts/Heebo-Bold.ttf')
};

const vfs = {};

for (const [name, filePath] of Object.entries(fonts)) {
  const buffer = fs.readFileSync(filePath);
  const base64 = buffer.toString('base64');
  vfs[name] = base64;
  console.log(`✓ Converted ${name} (${buffer.length} bytes -> ${base64.length} chars)`);
}

const outputPath = path.join(__dirname, 'src/heeboFonts.js');
const content = `// Auto-generated font file for pdfMake
export const heeboFonts = ${JSON.stringify(vfs, null, 2)};
`;

fs.writeFileSync(outputPath, content);
console.log(`\\n✓ Font VFS written to ${outputPath}`);
```

### 3. Run Conversion

```bash
node convert-fonts.js
rm convert-fonts.js
```

### 4. Verify

```bash
ls -lh src/heeboFonts.js
# Should show ~150KB file
```

## How It Works

1. **Font Loading**: The `pdfGenerator.js` imports pre-converted base64 fonts from `heeboFonts.js`
2. **Initialization**: Fonts are registered with pdfMake on first PDF generation
3. **Fallback**: If font loading fails, the system falls back to Roboto (Latin characters only)

## Troubleshooting

### Hebrew Text Shows as Boxes
- Ensure `src/heeboFonts.js` exists and is not corrupted
- Verify TTF files in `public/fonts/` are valid (use `file` command)
- Check browser console for font loading errors

### PDF Generation Fails
- Check for "Unknown font format" errors in console
- Regenerate fonts using instructions above
- Verify base64 encoding is correct

### Build Size Too Large
The `heeboFonts.js` file adds ~150KB to the bundle. This is necessary for Hebrew support. If size is critical, consider:
- Using web fonts instead of embedding in PDF
- Subsetting fonts to include only required characters
- Using a different PDF generation library

## License

Heebo font is licensed under the SIL Open Font License 1.1
- Copyright 2014 The Heebo Project Authors
- https://github.com/OdedEzer/heebo
